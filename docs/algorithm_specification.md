# SM-2 Algorithm Specification

This document provides a detailed specification of the SM-2 algorithm implementation for the Adaptive SM-2 Scheduler project. The implementation is located in `src/schedulers/sm2.py` and follows the professional project structure.

## Overview

The SM-2 algorithm is a spaced repetition scheduling algorithm developed by Piotr Wozniak for the SuperMemo system. It calculates the number of days to wait before reviewing a piece of information based on how easily the information was remembered.

## Algorithm Inputs

The algorithm requires four inputs:

1. **Quality**: An integer from 0-5 indicating how easily the information was remembered
2. **Repetitions**: The number of times the information has been reviewed prior to this review
3. **Previous Ease Factor**: A floating point number (≥ 1.3) generated by the last iteration
4. **Previous Interval**: Generated by the last iteration, indicates days to wait between reviews

## Quality Scale

The official algorithm description explains the meaning of each quality number:

- **5**: Perfect response
- **4**: Correct response after a hesitation
- **3**: Correct response recalled with serious difficulty
- **2**: Incorrect response; where the correct one seemed easy to recall
- **1**: Incorrect response; the correct one remembered
- **0**: Complete blackout

## Algorithm Steps

### Successful Recall (Quality ≥ 3)

1. **First Review** (repetitions = 0):
   - Set interval to 1 day

2. **Second Review** (repetitions = 1):
   - Set interval to 6 days

3. **Subsequent Reviews** (repetitions > 1):
   - Set interval to `ceil(previous_interval × previous_ease_factor)`

4. **Update Repetitions**:
   - Increment repetitions by 1

5. **Update Ease Factor**:
   ```
   new_ease_factor = previous_ease_factor + (0.1 - (5 - quality) × (0.08 + (5 - quality) × 0.02))
   ```

6. **Enforce Minimum**:
   - If new_ease_factor < 1.3, set to 1.3

### Failed Recall (Quality < 3)

1. **Reset Repetitions**: Set to 0
2. **Reset Interval**: Set to 1 day
3. **Keep Ease Factor**: No change to previous ease factor

## Ease Factor Formula

The ease factor adjustment formula:

```
new_ease_factor = previous_ease_factor + (0.1 - (5 - quality) × (0.08 + (5 - quality) × 0.02))
```

This formula:
- Increases ease factor when quality is 5 (perfect)
- Makes no change when quality is 4 (good)
- Decreases ease factor by varying amounts when quality is lower than 4
- The lower the quality, the more the ease factor decreases

## Algorithm Outputs

The algorithm returns three outputs:

1. **Interval**: Number of days to wait before the next review
2. **Repetitions**: Number of times the information has been reviewed
3. **Ease Factor**: Updated ease factor for future calculations

## Implementation Details

### Default Values

- **Initial Ease Factor**: 2.5
- **Minimum Ease Factor**: 1.3
- **First Interval**: 1 day
- **Second Interval**: 6 days

### Edge Cases

- Quality values outside 0-5 range are invalid
- Ease factor is bounded at minimum 1.3
- Failed recalls reset the learning process

### Memory Modeling

The implementation uses exponential forgetting curves to model memory retention:

```
R(t) = 2^(-t/S)
```

Where:
- R(t): Recall probability at time t
- t: Days since last review
- S: Memory stability (approximated from ease factor)

## Validation

The implementation has been validated against:
- Official SuperMemo documentation
- Published algorithm specifications
- Comprehensive test cases covering all scenarios

## References

- Wozniak, P. (1990). Application of a computer to improve the results obtained in working with the SuperMemo method
- SuperMemo Algorithm SM-2: https://www.supermemo.com/en/blog/application-of-a-computer-to-improve-the-results-obtained-in-working-with-the-supermemo-method
